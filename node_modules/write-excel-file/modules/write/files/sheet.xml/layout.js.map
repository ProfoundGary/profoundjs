{"version":3,"file":"layout.js","names":["$attr","generateLayout","_ref","sheetId","orientation","layout","marginLeft","marginRight","marginTop","marginBottom","header","footer","concat","paperSize"],"sources":["../../../../source/write/files/sheet.xml/layout.js"],"sourcesContent":["import $attr from '../../../xml/sanitizeAttributeValue.js'\r\n\r\nexport default function generateLayout({\r\n\tsheetId,\r\n\torientation\r\n}) {\r\n\tlet layout = ''\r\n\r\n\t// Margins are required when setting custom orientation,\r\n\t// otherwise they'd be `0`.\r\n\t// https://gitlab.com/catamphetamine/write-excel-file/-/issues/7#note_782347297\r\n\tif (orientation) {\r\n\t\t// Page margins (when printing).\r\n\t\t// https://github.com/randym/axlsx/blob/master/lib/axlsx/workbook/worksheet/page_margins.rb\r\n\r\n\t\tconst marginLeft = 0.7 // The left margin in inches.\r\n\t\tconst marginRight = 0.7 // The right margin in inches.\r\n\t\tconst marginTop = 0.75 // The top margin in inches.\r\n\t\tconst marginBottom = 0.75 // The bottom margin in inches.\r\n\t\tconst header = 0.3 // The header margin in inches.\r\n\t\tconst footer = 0.3 // The footer margin in inches.\r\n\r\n\t\tlayout += '<pageMargins'\r\n\t\tlayout += ` left=\"${marginLeft}\"`\r\n\t\tlayout += ` right=\"${marginRight}\"`\r\n\t\tlayout += ` top=\"${marginTop}\"`\r\n\t\tlayout += ` bottom=\"${marginBottom}\"`\r\n\t\tlayout += ` header=\"${header}\"`\r\n\t\tlayout += ` footer=\"${footer}\"`\r\n\t\tlayout += '/>'\r\n\t}\r\n\r\n\t// Allows setting \"landscape\" orientation.\r\n\t// https://gitlab.com/catamphetamine/write-excel-file/-/issues/7\r\n\tif (orientation) {\r\n\t\t// Paper size (when printing).\r\n\t\t// https://github.com/randym/axlsx/blob/master/lib/axlsx/workbook/worksheet/page_setup.rb\r\n\t\t//\r\n\t\t// `paperSize` `9` means \"A4 paper (210 mm by 297 mm)\".\r\n\t\t//\r\n\t\tconst paperSize = 9\r\n\r\n\t\t// Page orientation (when printing).\r\n\t\t//\r\n\t\t// `orientation` can be:\r\n\t\t// * `landscape`\r\n\t\t// * `portrait`\r\n\t\t// https://docs.microsoft.com/en-us/office/vba/api/excel.pagesetup.orientation\r\n\r\n\t\tlayout += '<pageSetup'\r\n\t\tlayout += ` paperSize=\"${paperSize}\"`\r\n\t\tlayout += ` orientation=\"${$attr(orientation)}\"`\r\n\t\tlayout += ` r:id=\"rId${sheetId}\"`\r\n\t\tlayout += '/>'\r\n\t}\r\n\r\n\treturn layout\r\n}"],"mappings":"AAAA,OAAOA,KAAK,MAAM,wCAAwC;AAE1D,eAAe,SAASC,cAAcA,CAAAC,IAAA,EAGnC;EAAA,IAFFC,OAAO,GAAAD,IAAA,CAAPC,OAAO;IACPC,WAAW,GAAAF,IAAA,CAAXE,WAAW;EAEX,IAAIC,MAAM,GAAG,EAAE;;EAEf;EACA;EACA;EACA,IAAID,WAAW,EAAE;IAChB;IACA;;IAEA,IAAME,UAAU,GAAG,GAAG,EAAC;IACvB,IAAMC,WAAW,GAAG,GAAG,EAAC;IACxB,IAAMC,SAAS,GAAG,IAAI,EAAC;IACvB,IAAMC,YAAY,GAAG,IAAI,EAAC;IAC1B,IAAMC,MAAM,GAAG,GAAG,EAAC;IACnB,IAAMC,MAAM,GAAG,GAAG,EAAC;;IAEnBN,MAAM,IAAI,cAAc;IACxBA,MAAM,eAAAO,MAAA,CAAcN,UAAU,OAAG;IACjCD,MAAM,gBAAAO,MAAA,CAAeL,WAAW,OAAG;IACnCF,MAAM,cAAAO,MAAA,CAAaJ,SAAS,OAAG;IAC/BH,MAAM,iBAAAO,MAAA,CAAgBH,YAAY,OAAG;IACrCJ,MAAM,iBAAAO,MAAA,CAAgBF,MAAM,OAAG;IAC/BL,MAAM,iBAAAO,MAAA,CAAgBD,MAAM,OAAG;IAC/BN,MAAM,IAAI,IAAI;EACf;;EAEA;EACA;EACA,IAAID,WAAW,EAAE;IAChB;IACA;IACA;IACA;IACA;IACA,IAAMS,SAAS,GAAG,CAAC;;IAEnB;IACA;IACA;IACA;IACA;IACA;;IAEAR,MAAM,IAAI,YAAY;IACtBA,MAAM,oBAAAO,MAAA,CAAmBC,SAAS,OAAG;IACrCR,MAAM,sBAAAO,MAAA,CAAqBZ,KAAK,CAACI,WAAW,CAAC,OAAG;IAChDC,MAAM,kBAAAO,MAAA,CAAiBT,OAAO,OAAG;IACjCE,MAAM,IAAI,IAAI;EACf;EAEA,OAAOA,MAAM;AACd","ignoreList":[]}