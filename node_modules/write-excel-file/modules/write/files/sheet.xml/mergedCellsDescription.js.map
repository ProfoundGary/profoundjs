{"version":3,"file":"mergedCellsDescription.js","names":["generateCellNumber","generateMergedCellsDescription","mergedCells","length","concat","map","_ref","_ref2","_slicedToArray","from","to","coordinates","join"],"sources":["../../../../source/write/files/sheet.xml/mergedCellsDescription.js"],"sourcesContent":["import generateCellNumber from './helpers/generateCellNumber.js'\r\n\r\n// Supports \"merging cells\" across columns and rows.\r\n// https://rdrr.io/cran/openxlsx/man/mergeCells.html\r\n//\r\n// Returned XML example for merged cells range \"A2:C3\":\r\n// `<sheetData>...</sheetData><mergeCells count=\"1\"><mergeCell ref=\"A2:C3\"/></mergeCells>`\r\n//\r\n// Data example:\r\n//\r\n// rows:\r\n// [\r\n//   [...],\r\n//   [\r\n//     { type: String, value: 'abc', span: 3, rowSpan: 2 },\r\n//     { ... },\r\n//     { ... }\r\n//   ],\r\n//   [...]\r\n// ]\r\n\r\nexport default function generateMergedCellsDescription(mergedCells) {\r\n\tif (mergedCells.length === 0) {\r\n\t\treturn ''\r\n\t}\r\n\r\n\treturn `<mergeCells count=\"${mergedCells.length}\">` +\r\n\t\tmergedCells.map(([from, to]) => {\r\n\t\t\tconst coordinates =\r\n\t\t\t\tgenerateCellNumber(from[1], from[0] + 1) +\r\n\t\t\t\t':' +\r\n\t\t\t\tgenerateCellNumber(to[1], to[0] + 1)\r\n\t\t\treturn `<mergeCell ref=\"${coordinates}\"/>`\r\n\t\t}).join('') +\r\n\t\t'</mergeCells>'\r\n}"],"mappings":";;;;;;AAAA,OAAOA,kBAAkB,MAAM,iCAAiC;;AAEhE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,eAAe,SAASC,8BAA8BA,CAACC,WAAW,EAAE;EACnE,IAAIA,WAAW,CAACC,MAAM,KAAK,CAAC,EAAE;IAC7B,OAAO,EAAE;EACV;EAEA,OAAO,uBAAAC,MAAA,CAAsBF,WAAW,CAACC,MAAM,WAC9CD,WAAW,CAACG,GAAG,CAAC,UAAAC,IAAA,EAAgB;IAAA,IAAAC,KAAA,GAAAC,cAAA,CAAAF,IAAA;MAAdG,IAAI,GAAAF,KAAA;MAAEG,EAAE,GAAAH,KAAA;IACzB,IAAMI,WAAW,GAChBX,kBAAkB,CAACS,IAAI,CAAC,CAAC,CAAC,EAAEA,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,GACxC,GAAG,GACHT,kBAAkB,CAACU,EAAE,CAAC,CAAC,CAAC,EAAEA,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;IACrC,2BAAAN,MAAA,CAA0BO,WAAW;EACtC,CAAC,CAAC,CAACC,IAAI,CAAC,EAAE,CAAC,GACX,eAAe;AACjB","ignoreList":[]}