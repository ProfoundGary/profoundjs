{"version":3,"file":"[Content_Types].xml.js","names":["getFileExtensionForContentType","generateContentTypesXml","_ref","images","sheets","map","_ref2","id","concat","join","_ref3","getFileExtensionContentTypes","_ref4","fileExtension","contentType","fileExtensionContentTypes","addFileExtensionContentType","image","existingFileExtensionContentType","find","_","push","Array","isArray","_iterator","_createForOfIteratorHelperLoose","_step","done","sheetImages","value","_iterator2","_step2","_iterator3","_step3"],"sources":["../../../source/write/files/[Content_Types].xml.js"],"sourcesContent":["import getFileExtensionForContentType from '../getFileExtensionForContentType.js'\r\n\r\n// Copy-pasted from:\r\n// https://github.com/davidramos-om/zipcelx-on-steroids/blob/master/src/statics/%5BContent_Types%5D.xml.js\r\n\r\nexport default function generateContentTypesXml({ images, sheets }) {\r\n\treturn '<?xml version=\"1.0\" ?>' +\r\n\t\t'<Types xmlns=\"http://schemas.openxmlformats.org/package/2006/content-types\">' +\r\n\t\t\t'<Default ContentType=\"application/xml\" Extension=\"xml\"/>' +\r\n\t\t\t'<Default ContentType=\"application/vnd.openxmlformats-package.relationships+xml\" Extension=\"rels\"/>' +\r\n\t\t\tsheets.map(({ id }) => `<Override ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\" PartName=\"/xl/worksheets/sheet${id}.xml\"/>`).join('') +\r\n\t\t\tsheets.map(({ id, images }) => images ? `<Override ContentType=\"application/vnd.openxmlformats-officedocument.drawing+xml\" PartName=\"/xl/drawings/drawing${id}.xml\"/>` : '').join('') +\r\n\t\t\t'<Override ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\" PartName=\"/xl/workbook.xml\"/>' +\r\n\t\t\t'<Override ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml\" PartName=\"/xl/sharedStrings.xml\"/>' +\r\n\t\t\t'<Override ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\" PartName=\"/xl/styles.xml\"/>' +\r\n\t\t\tgetFileExtensionContentTypes(images).map(({ fileExtension, contentType }) => `<Default Extension=\"${fileExtension}\" ContentType=\"${contentType}\"/>`).join('') +\r\n\t\t'</Types>'\r\n}\r\n\r\nfunction getFileExtensionContentTypes(images) {\r\n\tif (!images) {\r\n\t\treturn []\r\n\t}\r\n\r\n\tconst fileExtensionContentTypes = []\r\n\r\n\tconst addFileExtensionContentType = (image) => {\r\n\t\tconst fileExtension = getFileExtensionForContentType(image.contentType)\r\n\t\tconst existingFileExtensionContentType = fileExtensionContentTypes.find(_ => _.fileExtension === fileExtension)\r\n\t\tif (!existingFileExtensionContentType) {\r\n\t\t\tfileExtensionContentTypes.push({\r\n\t\t\t\tfileExtension,\r\n\t\t\t\tcontentType: image.contentType\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tif (Array.isArray(images[0])) {\r\n\t\tfor (const sheetImages of images) {\r\n\t\t\tfor (const image of sheetImages) {\r\n\t\t\t\taddFileExtensionContentType(image)\r\n\t\t\t}\r\n\t\t}\r\n\t} else {\r\n\t\tfor (const image of images) {\r\n\t\t\taddFileExtensionContentType(image)\r\n\t\t}\r\n\t}\r\n\r\n\treturn fileExtensionContentTypes\r\n}"],"mappings":";;;AAAA,OAAOA,8BAA8B,MAAM,sCAAsC;;AAEjF;AACA;;AAEA,eAAe,SAASC,uBAAuBA,CAAAC,IAAA,EAAqB;EAAA,IAAlBC,MAAM,GAAAD,IAAA,CAANC,MAAM;IAAEC,MAAM,GAAAF,IAAA,CAANE,MAAM;EAC/D,OAAO,wBAAwB,GAC9B,8EAA8E,GAC7E,0DAA0D,GAC1D,oGAAoG,GACpGA,MAAM,CAACC,GAAG,CAAC,UAAAC,KAAA;IAAA,IAAGC,EAAE,GAAAD,KAAA,CAAFC,EAAE;IAAA,6IAAAC,MAAA,CAA0ID,EAAE;EAAA,CAAS,CAAC,CAACE,IAAI,CAAC,EAAE,CAAC,GAC/KL,MAAM,CAACC,GAAG,CAAC,UAAAK,KAAA;IAAA,IAAGH,EAAE,GAAAG,KAAA,CAAFH,EAAE;MAAEJ,MAAM,GAAAO,KAAA,CAANP,MAAM;IAAA,OAAOA,MAAM,yHAAAK,MAAA,CAAsHD,EAAE,gBAAY,EAAE;EAAA,EAAC,CAACE,IAAI,CAAC,EAAE,CAAC,GACrL,kIAAkI,GAClI,0IAA0I,GAC1I,4HAA4H,GAC5HE,4BAA4B,CAACR,MAAM,CAAC,CAACE,GAAG,CAAC,UAAAO,KAAA;IAAA,IAAGC,aAAa,GAAAD,KAAA,CAAbC,aAAa;MAAEC,WAAW,GAAAF,KAAA,CAAXE,WAAW;IAAA,+BAAAN,MAAA,CAA8BK,aAAa,uBAAAL,MAAA,CAAkBM,WAAW;EAAA,CAAK,CAAC,CAACL,IAAI,CAAC,EAAE,CAAC,GAC9J,UAAU;AACZ;AAEA,SAASE,4BAA4BA,CAACR,MAAM,EAAE;EAC7C,IAAI,CAACA,MAAM,EAAE;IACZ,OAAO,EAAE;EACV;EAEA,IAAMY,yBAAyB,GAAG,EAAE;EAEpC,IAAMC,2BAA2B,GAAG,SAA9BA,2BAA2BA,CAAIC,KAAK,EAAK;IAC9C,IAAMJ,aAAa,GAAGb,8BAA8B,CAACiB,KAAK,CAACH,WAAW,CAAC;IACvE,IAAMI,gCAAgC,GAAGH,yBAAyB,CAACI,IAAI,CAAC,UAAAC,CAAC;MAAA,OAAIA,CAAC,CAACP,aAAa,KAAKA,aAAa;IAAA,EAAC;IAC/G,IAAI,CAACK,gCAAgC,EAAE;MACtCH,yBAAyB,CAACM,IAAI,CAAC;QAC9BR,aAAa,EAAbA,aAAa;QACbC,WAAW,EAAEG,KAAK,CAACH;MACpB,CAAC,CAAC;IACH;EACD,CAAC;EAED,IAAIQ,KAAK,CAACC,OAAO,CAACpB,MAAM,CAAC,CAAC,CAAC,CAAC,EAAE;IAC7B,SAAAqB,SAAA,GAAAC,+BAAA,CAA0BtB,MAAM,GAAAuB,KAAA,IAAAA,KAAA,GAAAF,SAAA,IAAAG,IAAA,GAAE;MAAA,IAAvBC,WAAW,GAAAF,KAAA,CAAAG,KAAA;MACrB,SAAAC,UAAA,GAAAL,+BAAA,CAAoBG,WAAW,GAAAG,MAAA,IAAAA,MAAA,GAAAD,UAAA,IAAAH,IAAA,GAAE;QAAA,IAAtBV,KAAK,GAAAc,MAAA,CAAAF,KAAA;QACfb,2BAA2B,CAACC,KAAK,CAAC;MACnC;IACD;EACD,CAAC,MAAM;IACN,SAAAe,UAAA,GAAAP,+BAAA,CAAoBtB,MAAM,GAAA8B,MAAA,IAAAA,MAAA,GAAAD,UAAA,IAAAL,IAAA,GAAE;MAAA,IAAjBV,MAAK,GAAAgB,MAAA,CAAAJ,KAAA;MACfb,2BAA2B,CAACC,MAAK,CAAC;IACnC;EACD;EAEA,OAAOF,yBAAyB;AACjC","ignoreList":[]}