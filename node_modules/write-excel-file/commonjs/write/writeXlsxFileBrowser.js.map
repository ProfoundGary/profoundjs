{"version":3,"file":"writeXlsxFileBrowser.js","names":["_jszip","_interopRequireDefault","require","_fileSaver","_getImageFileName","_workbookXml","_workbookXmlRels","_rels","_Content_TypesXml","_drawingXml","_drawingXmlRels","_sheetXmlRels","_sharedStringsXml","_stylesXml","_writeXlsxFileCommon","_excluded","e","__esModule","_createForOfIteratorHelperLoose","r","t","Symbol","iterator","call","next","bind","Array","isArray","_unsupportedIterableToArray","length","o","done","value","TypeError","a","_arrayLikeToArray","toString","slice","constructor","name","from","test","n","_objectWithoutProperties","i","_objectWithoutPropertiesLoose","Object","getOwnPropertySymbols","indexOf","propertyIsEnumerable","hasOwnProperty","writeXlsxFile","data","_ref","arguments","undefined","fileName","rest","generateXlsxFile","then","blob","FileSaver","saveAs","_ref2","sheetName","sheet","sheetNames","sheets","schema","columns","images","headerStyle","getHeaderStyle","fontFamily","fontSize","orientation","stickyRowsCount","stickyColumnsCount","showGridLines","rightToLeft","dateFormat","zip","JSZip","_generateSheets","generateSheets","getSharedStrings","getStyles","file","rels","generateContentTypesXml","xl","folder","generateWorkbookXmlRels","generateWorkbookXml","generateStylesXml","generateSharedStringsXml","_iterator","_step","_step$value","id","concat","generateSheetXmlRels","generateDrawingXml","generateDrawingXmlRels","sheetId","_iterator2","_step2","image","getImageFileName","sheetImages","content","generateAsync","type","mimeType","compression"],"sources":["../../source/write/writeXlsxFileBrowser.js"],"sourcesContent":["// Copy-pasted from:\r\n// https://github.com/davidramos-om/zipcelx-on-steroids/blob/master/src/zipcelx.js\r\n\r\nimport JSZip from 'jszip'\r\nimport FileSaver from 'file-saver'\r\n\r\nimport getImageFileName from './getImageFileName.js'\r\n\r\nimport generateWorkbookXml from './files/workbook.xml.js'\r\nimport generateWorkbookXmlRels from './files/workbook.xml.rels.js'\r\nimport rels from './files/rels.js'\r\nimport generateContentTypesXml from './files/[Content_Types].xml.js'\r\nimport generateDrawingXml from './files/drawing.xml.js'\r\nimport generateDrawingXmlRels from './files/drawing.xml.rels.js'\r\nimport generateSheetXmlRels from './files/sheet.xml.rels.js'\r\nimport generateSharedStringsXml from './files/sharedStrings.xml.js'\r\nimport generateStylesXml from './files/styles.xml.js'\r\n\r\nimport { generateSheets } from './writeXlsxFile.common.js'\r\n\r\nexport default function writeXlsxFile(data, { fileName, ...rest } = {}) {\r\n  return generateXlsxFile(data, rest).then((blob) => {\r\n    if (fileName) {\r\n      return FileSaver.saveAs(blob, fileName)\r\n    }\r\n    return blob\r\n  })\r\n}\r\n\r\n/**\r\n * Writes an *.xlsx file into a \"blob\".\r\n * https://github.com/egeriis/zipcelx/issues/68\r\n * \"The reason if you want to send the excel file or store it natively on Cordova/capacitor app\".\r\n * @return {Blob}\r\n */\r\nfunction generateXlsxFile(data, {\r\n  sheet: sheetName,\r\n  sheets: sheetNames,\r\n  schema,\r\n  columns,\r\n  images,\r\n  headerStyle,\r\n  getHeaderStyle,\r\n  fontFamily,\r\n  fontSize,\r\n  orientation,\r\n  stickyRowsCount,\r\n  stickyColumnsCount,\r\n  showGridLines,\r\n  rightToLeft,\r\n  dateFormat\r\n}) {\r\n  const zip = new JSZip()\r\n\r\n  const {\r\n    sheets,\r\n    getSharedStrings,\r\n    getStyles\r\n  } = generateSheets({\r\n    data,\r\n    sheetName,\r\n    sheetNames,\r\n    schema,\r\n    columns,\r\n    images,\r\n    headerStyle,\r\n    getHeaderStyle,\r\n    fontFamily,\r\n    fontSize,\r\n    orientation,\r\n    stickyRowsCount,\r\n    stickyColumnsCount,\r\n    showGridLines,\r\n    rightToLeft,\r\n    dateFormat\r\n  })\r\n\r\n  zip.file('_rels/.rels', rels)\r\n\r\n  zip.file('[Content_Types].xml', generateContentTypesXml({ images, sheets }))\r\n\r\n  const xl = zip.folder('xl')\r\n  xl.file('_rels/workbook.xml.rels', generateWorkbookXmlRels({ sheets }))\r\n  xl.file('workbook.xml', generateWorkbookXml({ sheets, stickyRowsCount, stickyColumnsCount }))\r\n  xl.file('styles.xml', generateStylesXml(getStyles()))\r\n  xl.file('sharedStrings.xml', generateSharedStringsXml(getSharedStrings()))\r\n\r\n  for (const { id, data, images } of sheets) {\r\n    xl.file(`worksheets/sheet${id}.xml`, data)\r\n    xl.file(`worksheets/_rels/sheet${id}.xml.rels`, generateSheetXmlRels({ id, images }))\r\n    if (images) {\r\n      xl.file(`drawings/drawing${id}.xml`, generateDrawingXml({ images }))\r\n      xl.file(`drawings/_rels/drawing${id}.xml.rels`, generateDrawingXmlRels({ images, sheetId: id }))\r\n      // Copy images to `xl/media` folder.\r\n      for (const image of images) {\r\n        // According to `JSZip` docs:\r\n        // https://stuk.github.io/jszip/documentation/api_jszip/file_data.html\r\n        // `.file()` function supports `data` argument of type:\r\n        // * String\r\n        // * ArrayBuffer\r\n        // * Uint8Array\r\n        // * Buffer\r\n        // * Blob\r\n        // * Promise\r\n        // * Nodejs stream\r\n        xl.file(`media/${getImageFileName(image, { sheetId: id, sheetImages: images })}`, image.content)\r\n      }\r\n    }\r\n  }\r\n\r\n  return zip.generateAsync({\r\n    type: 'blob',\r\n    mimeType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\r\n    compression: 'deflate'\r\n  })\r\n}"],"mappings":";;;;;;AAGA,IAAAA,MAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,UAAA,GAAAF,sBAAA,CAAAC,OAAA;AAEA,IAAAE,iBAAA,GAAAH,sBAAA,CAAAC,OAAA;AAEA,IAAAG,YAAA,GAAAJ,sBAAA,CAAAC,OAAA;AACA,IAAAI,gBAAA,GAAAL,sBAAA,CAAAC,OAAA;AACA,IAAAK,KAAA,GAAAN,sBAAA,CAAAC,OAAA;AACA,IAAAM,iBAAA,GAAAP,sBAAA,CAAAC,OAAA;AACA,IAAAO,WAAA,GAAAR,sBAAA,CAAAC,OAAA;AACA,IAAAQ,eAAA,GAAAT,sBAAA,CAAAC,OAAA;AACA,IAAAS,aAAA,GAAAV,sBAAA,CAAAC,OAAA;AACA,IAAAU,iBAAA,GAAAX,sBAAA,CAAAC,OAAA;AACA,IAAAW,UAAA,GAAAZ,sBAAA,CAAAC,OAAA;AAEA,IAAAY,oBAAA,GAAAZ,OAAA;AAA0D,IAAAa,SAAA,iBAlB1D;AACA;AAAA,SAAAd,uBAAAe,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,gBAAAA,CAAA;AAAA,SAAAE,gCAAAC,CAAA,EAAAH,CAAA,QAAAI,CAAA,yBAAAC,MAAA,IAAAF,CAAA,CAAAE,MAAA,CAAAC,QAAA,KAAAH,CAAA,oBAAAC,CAAA,UAAAA,CAAA,GAAAA,CAAA,CAAAG,IAAA,CAAAJ,CAAA,GAAAK,IAAA,CAAAC,IAAA,CAAAL,CAAA,OAAAM,KAAA,CAAAC,OAAA,CAAAR,CAAA,MAAAC,CAAA,GAAAQ,2BAAA,CAAAT,CAAA,MAAAH,CAAA,IAAAG,CAAA,uBAAAA,CAAA,CAAAU,MAAA,IAAAT,CAAA,KAAAD,CAAA,GAAAC,CAAA,OAAAU,CAAA,kCAAAA,CAAA,IAAAX,CAAA,CAAAU,MAAA,KAAAE,IAAA,WAAAA,IAAA,MAAAC,KAAA,EAAAb,CAAA,CAAAW,CAAA,sBAAAG,SAAA;AAAA,SAAAL,4BAAAT,CAAA,EAAAe,CAAA,QAAAf,CAAA,2BAAAA,CAAA,SAAAgB,iBAAA,CAAAhB,CAAA,EAAAe,CAAA,OAAAd,CAAA,MAAAgB,QAAA,CAAAb,IAAA,CAAAJ,CAAA,EAAAkB,KAAA,6BAAAjB,CAAA,IAAAD,CAAA,CAAAmB,WAAA,KAAAlB,CAAA,GAAAD,CAAA,CAAAmB,WAAA,CAAAC,IAAA,aAAAnB,CAAA,cAAAA,CAAA,GAAAM,KAAA,CAAAc,IAAA,CAAArB,CAAA,oBAAAC,CAAA,+CAAAqB,IAAA,CAAArB,CAAA,IAAAe,iBAAA,CAAAhB,CAAA,EAAAe,CAAA;AAAA,SAAAC,kBAAAhB,CAAA,EAAAe,CAAA,aAAAA,CAAA,IAAAA,CAAA,GAAAf,CAAA,CAAAU,MAAA,MAAAK,CAAA,GAAAf,CAAA,CAAAU,MAAA,YAAAb,CAAA,MAAA0B,CAAA,GAAAhB,KAAA,CAAAQ,CAAA,GAAAlB,CAAA,GAAAkB,CAAA,EAAAlB,CAAA,IAAA0B,CAAA,CAAA1B,CAAA,IAAAG,CAAA,CAAAH,CAAA,UAAA0B,CAAA;AAAA,SAAAC,yBAAA3B,CAAA,EAAAI,CAAA,gBAAAJ,CAAA,iBAAAc,CAAA,EAAAX,CAAA,EAAAyB,CAAA,GAAAC,6BAAA,CAAA7B,CAAA,EAAAI,CAAA,OAAA0B,MAAA,CAAAC,qBAAA,QAAAL,CAAA,GAAAI,MAAA,CAAAC,qBAAA,CAAA/B,CAAA,QAAAG,CAAA,MAAAA,CAAA,GAAAuB,CAAA,CAAAb,MAAA,EAAAV,CAAA,IAAAW,CAAA,GAAAY,CAAA,CAAAvB,CAAA,UAAAC,CAAA,CAAA4B,OAAA,CAAAlB,CAAA,QAAAmB,oBAAA,CAAA1B,IAAA,CAAAP,CAAA,EAAAc,CAAA,MAAAc,CAAA,CAAAd,CAAA,IAAAd,CAAA,CAAAc,CAAA,aAAAc,CAAA;AAAA,SAAAC,8BAAA1B,CAAA,EAAAH,CAAA,gBAAAG,CAAA,iBAAAC,CAAA,gBAAAsB,CAAA,IAAAvB,CAAA,SAAA+B,cAAA,CAAA3B,IAAA,CAAAJ,CAAA,EAAAuB,CAAA,gBAAA1B,CAAA,CAAAgC,OAAA,CAAAN,CAAA,aAAAtB,CAAA,CAAAsB,CAAA,IAAAvB,CAAA,CAAAuB,CAAA,YAAAtB,CAAA;AAmBe,SAAS+B,aAAaA,CAACC,IAAI,EAA8B;EAAA,IAAAC,IAAA,GAAAC,SAAA,CAAAzB,MAAA,QAAAyB,SAAA,QAAAC,SAAA,GAAAD,SAAA,MAAJ,CAAC,CAAC;IAAxBE,QAAQ,GAAAH,IAAA,CAARG,QAAQ;IAAKC,IAAI,GAAAd,wBAAA,CAAAU,IAAA,EAAAtC,SAAA;EAC7D,OAAO2C,gBAAgB,CAACN,IAAI,EAAEK,IAAI,CAAC,CAACE,IAAI,CAAC,UAACC,IAAI,EAAK;IACjD,IAAIJ,QAAQ,EAAE;MACZ,OAAOK,qBAAS,CAACC,MAAM,CAACF,IAAI,EAAEJ,QAAQ,CAAC;IACzC;IACA,OAAOI,IAAI;EACb,CAAC,CAAC;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAASF,gBAAgBA,CAACN,IAAI,EAAAW,KAAA,EAgB3B;EAAA,IAfMC,SAAS,GAAAD,KAAA,CAAhBE,KAAK;IACGC,UAAU,GAAAH,KAAA,CAAlBI,MAAM;IACNC,MAAM,GAAAL,KAAA,CAANK,MAAM;IACNC,OAAO,GAAAN,KAAA,CAAPM,OAAO;IACPC,MAAM,GAAAP,KAAA,CAANO,MAAM;IACNC,WAAW,GAAAR,KAAA,CAAXQ,WAAW;IACXC,cAAc,GAAAT,KAAA,CAAdS,cAAc;IACdC,UAAU,GAAAV,KAAA,CAAVU,UAAU;IACVC,QAAQ,GAAAX,KAAA,CAARW,QAAQ;IACRC,WAAW,GAAAZ,KAAA,CAAXY,WAAW;IACXC,eAAe,GAAAb,KAAA,CAAfa,eAAe;IACfC,kBAAkB,GAAAd,KAAA,CAAlBc,kBAAkB;IAClBC,aAAa,GAAAf,KAAA,CAAbe,aAAa;IACbC,WAAW,GAAAhB,KAAA,CAAXgB,WAAW;IACXC,UAAU,GAAAjB,KAAA,CAAViB,UAAU;EAEV,IAAMC,GAAG,GAAG,IAAIC,iBAAK,CAAC,CAAC;EAEvB,IAAAC,eAAA,GAII,IAAAC,mCAAc,EAAC;MACjBhC,IAAI,EAAJA,IAAI;MACJY,SAAS,EAATA,SAAS;MACTE,UAAU,EAAVA,UAAU;MACVE,MAAM,EAANA,MAAM;MACNC,OAAO,EAAPA,OAAO;MACPC,MAAM,EAANA,MAAM;MACNC,WAAW,EAAXA,WAAW;MACXC,cAAc,EAAdA,cAAc;MACdC,UAAU,EAAVA,UAAU;MACVC,QAAQ,EAARA,QAAQ;MACRC,WAAW,EAAXA,WAAW;MACXC,eAAe,EAAfA,eAAe;MACfC,kBAAkB,EAAlBA,kBAAkB;MAClBC,aAAa,EAAbA,aAAa;MACbC,WAAW,EAAXA,WAAW;MACXC,UAAU,EAAVA;IACF,CAAC,CAAC;IApBAb,MAAM,GAAAgB,eAAA,CAANhB,MAAM;IACNkB,gBAAgB,GAAAF,eAAA,CAAhBE,gBAAgB;IAChBC,SAAS,GAAAH,eAAA,CAATG,SAAS;EAoBXL,GAAG,CAACM,IAAI,CAAC,aAAa,EAAEC,gBAAI,CAAC;EAE7BP,GAAG,CAACM,IAAI,CAAC,qBAAqB,EAAE,IAAAE,4BAAuB,EAAC;IAAEnB,MAAM,EAANA,MAAM;IAAEH,MAAM,EAANA;EAAO,CAAC,CAAC,CAAC;EAE5E,IAAMuB,EAAE,GAAGT,GAAG,CAACU,MAAM,CAAC,IAAI,CAAC;EAC3BD,EAAE,CAACH,IAAI,CAAC,yBAAyB,EAAE,IAAAK,2BAAuB,EAAC;IAAEzB,MAAM,EAANA;EAAO,CAAC,CAAC,CAAC;EACvEuB,EAAE,CAACH,IAAI,CAAC,cAAc,EAAE,IAAAM,uBAAmB,EAAC;IAAE1B,MAAM,EAANA,MAAM;IAAES,eAAe,EAAfA,eAAe;IAAEC,kBAAkB,EAAlBA;EAAmB,CAAC,CAAC,CAAC;EAC7Fa,EAAE,CAACH,IAAI,CAAC,YAAY,EAAE,IAAAO,qBAAiB,EAACR,SAAS,CAAC,CAAC,CAAC,CAAC;EACrDI,EAAE,CAACH,IAAI,CAAC,mBAAmB,EAAE,IAAAQ,4BAAwB,EAACV,gBAAgB,CAAC,CAAC,CAAC,CAAC;EAE1E,SAAAW,SAAA,GAAA9E,+BAAA,CAAmCiD,MAAM,GAAA8B,KAAA,IAAAA,KAAA,GAAAD,SAAA,IAAAjE,IAAA,GAAE;IAAA,IAAAmE,WAAA,GAAAD,KAAA,CAAAjE,KAAA;MAA9BmE,EAAE,GAAAD,WAAA,CAAFC,EAAE;MAAE/C,KAAI,GAAA8C,WAAA,CAAJ9C,IAAI;MAAEkB,OAAM,GAAA4B,WAAA,CAAN5B,MAAM;IAC3BoB,EAAE,CAACH,IAAI,oBAAAa,MAAA,CAAoBD,EAAE,WAAQ/C,KAAI,CAAC;IAC1CsC,EAAE,CAACH,IAAI,0BAAAa,MAAA,CAA0BD,EAAE,gBAAa,IAAAE,wBAAoB,EAAC;MAAEF,EAAE,EAAFA,EAAE;MAAE7B,MAAM,EAANA;IAAO,CAAC,CAAC,CAAC;IACrF,IAAIA,OAAM,EAAE;MACVoB,EAAE,CAACH,IAAI,oBAAAa,MAAA,CAAoBD,EAAE,WAAQ,IAAAG,sBAAkB,EAAC;QAAEhC,MAAM,EAANA;MAAO,CAAC,CAAC,CAAC;MACpEoB,EAAE,CAACH,IAAI,0BAAAa,MAAA,CAA0BD,EAAE,gBAAa,IAAAI,0BAAsB,EAAC;QAAEjC,MAAM,EAANA,OAAM;QAAEkC,OAAO,EAAEL;MAAG,CAAC,CAAC,CAAC;MAChG;MACA,SAAAM,UAAA,GAAAvF,+BAAA,CAAoBoD,OAAM,GAAAoC,MAAA,IAAAA,MAAA,GAAAD,UAAA,IAAA1E,IAAA,GAAE;QAAA,IAAjB4E,KAAK,GAAAD,MAAA,CAAA1E,KAAA;QACd;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA0D,EAAE,CAACH,IAAI,UAAAa,MAAA,CAAU,IAAAQ,4BAAgB,EAACD,KAAK,EAAE;UAAEH,OAAO,EAAEL,EAAE;UAAEU,WAAW,EAAEvC;QAAO,CAAC,CAAC,GAAIqC,KAAK,CAACG,OAAO,CAAC;MAClG;IACF;EACF;EAEA,OAAO7B,GAAG,CAAC8B,aAAa,CAAC;IACvBC,IAAI,EAAE,MAAM;IACZC,QAAQ,EAAE,mEAAmE;IAC7EC,WAAW,EAAE;EACf,CAAC,CAAC;AACJ","ignoreList":[]}