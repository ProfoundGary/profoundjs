{"version":3,"file":"styles.js","names":["_sanitizeAttributeValue","_interopRequireDefault","require","e","__esModule","FORMAT_ID_STARTS_FROM","exports","initStyles","_ref","defaultFontFamily","fontFamily","defaultFontSize","fontSize","customFont","Boolean","undefined","formats","formatsIndex","styles","stylesIndex","fonts","fontsIndex","fills","fillsIndex","borders","bordersIndex","push","size","family","custom","left","right","top","bottom","gray125","getStyle","_ref2","_ref3","align","alignVertical","textRotation","indent","wrap","fontWeight","fontStyle","color","backgroundColor","borderColor","borderStyle","leftBorderColor","leftBorderStyle","rightBorderColor","rightBorderStyle","topBorderColor","topBorderStyle","bottomBorderColor","bottomBorderStyle","format","border","fontKey","concat","fillKey","borderKey","key","styleId","formatId","String","length","fontId","weight","style","fillId","borderId","getStyles"],"sources":["../../source/write/styles.js"],"sourcesContent":["import $attr from '../xml/sanitizeAttributeValue.js'\r\n\r\n// There seem to be about 100 \"built-in\" formats in Excel.\r\n// https://docs.microsoft.com/en-us/previous-versions/office/developer/office-2010/ee857658(v=office.14)?redirectedfrom=MSDN\r\nexport const FORMAT_ID_STARTS_FROM = 100\r\n\r\nexport default function initStyles({\r\n  fontFamily: defaultFontFamily,\r\n  fontSize: defaultFontSize\r\n}) {\r\n  const customFont = Boolean(defaultFontFamily || defaultFontSize)\r\n\r\n  if (defaultFontFamily === undefined) {\r\n    defaultFontFamily = 'Calibri'\r\n  }\r\n\r\n  if (defaultFontSize === undefined) {\r\n    defaultFontSize = 12\r\n  }\r\n\r\n  const formats = []\r\n  const formatsIndex = {}\r\n\r\n  const styles = []\r\n  const stylesIndex = {}\r\n\r\n  const fonts = []\r\n  const fontsIndex = {}\r\n\r\n  const fills = []\r\n  const fillsIndex = {}\r\n\r\n  const borders = []\r\n  const bordersIndex = {}\r\n\r\n  // Default font.\r\n  fonts.push({\r\n    size: defaultFontSize,\r\n    family: defaultFontFamily,\r\n    custom: customFont\r\n  })\r\n  fontsIndex['-:-'] = 0\r\n\r\n  // Default fill.\r\n  fills.push({})\r\n  fillsIndex['-'] = 0\r\n\r\n  // Default border.\r\n  borders.push({\r\n    left: {},\r\n    right: {},\r\n    top: {},\r\n    bottom: {}\r\n  })\r\n  bordersIndex['-:-/-:-/-:-/-:-'] = 0\r\n\r\n  // \"gray125\" fill.\r\n  // For some weird reason, MS Office 2007 Excel seems to require that to be present.\r\n  // Otherwise, if absent, it would replace the first `backgroundColor`.\r\n  fills.push({\r\n    gray125: true\r\n  })\r\n\r\n  function getStyle({\r\n    align,\r\n    alignVertical,\r\n    textRotation,\r\n    indent,\r\n    wrap,\r\n    fontFamily,\r\n    fontSize,\r\n    fontWeight,\r\n    fontStyle,\r\n    color,\r\n    backgroundColor,\r\n    borderColor,\r\n    borderStyle,\r\n    leftBorderColor,\r\n    leftBorderStyle,\r\n    rightBorderColor,\r\n    rightBorderStyle,\r\n    topBorderColor,\r\n    topBorderStyle,\r\n    bottomBorderColor,\r\n    bottomBorderStyle\r\n  }, {\r\n    format\r\n  }) {\r\n    // Custom borders aren't supported.\r\n    const border = undefined\r\n    // Look for an existing style.\r\n    const fontKey = `${fontFamily || '-'}:${fontSize || '-'}:${fontWeight || '-'}:${fontStyle || '-'}:${color || '-'}`\r\n    const fillKey = backgroundColor || '-'\r\n    const borderKey =\r\n      `${(topBorderColor || borderColor) || '-'}:${(topBorderStyle || borderStyle) || '-'}` +\r\n      '/' +\r\n      `${(rightBorderColor || borderColor) || '-'}:${(rightBorderStyle || borderStyle) || '-'}` +\r\n      '/' +\r\n      `${(bottomBorderColor || borderColor) || '-'}:${(bottomBorderStyle || borderStyle) || '-'}` +\r\n      '/' +\r\n      `${(leftBorderColor || borderColor) || '-'}:${(leftBorderStyle || borderStyle) || '-'}`\r\n    const key = `${align || '-'}/${alignVertical || '-'}/${textRotation || '-'}/${indent || '-'}/${wrap || '-'}/${format || '-'}/${fontKey}/${fillKey}/${borderKey}`\r\n    const styleId = stylesIndex[key]\r\n    if (styleId !== undefined) {\r\n      return styleId\r\n    }\r\n    // Create new style.\r\n    // Get format ID.\r\n    let formatId\r\n    if (format) {\r\n      formatId = formatsIndex[format]\r\n      if (formatId === undefined) {\r\n        formatId = formatsIndex[format] = String(FORMAT_ID_STARTS_FROM + formats.length)\r\n        formats.push(format)\r\n      }\r\n    }\r\n    // Get font ID.\r\n    let fontId = customFont ? 0 : undefined\r\n    if (fontFamily || fontSize || fontWeight || fontStyle || color) {\r\n      fontId = fontsIndex[fontKey]\r\n      if (fontId === undefined) {\r\n        fontId = fontsIndex[fontKey] = String(fonts.length)\r\n        fonts.push({\r\n          custom: true,\r\n          size: fontSize || defaultFontSize,\r\n          family: fontFamily || defaultFontFamily,\r\n          weight: fontWeight,\r\n          style: fontStyle,\r\n          color\r\n        })\r\n      }\r\n    }\r\n    // Get fill ID.\r\n    let fillId\r\n    if (backgroundColor) {\r\n      fillId = fillsIndex[fillKey]\r\n      if (fillId === undefined) {\r\n        fillId = fillsIndex[fillKey] = String(fills.length)\r\n        fills.push({\r\n          color: backgroundColor\r\n        })\r\n      }\r\n    }\r\n    // Get border ID.\r\n    let borderId\r\n    if (\r\n      borderColor ||\r\n      borderStyle ||\r\n      leftBorderColor ||\r\n      leftBorderStyle ||\r\n      rightBorderColor ||\r\n      rightBorderStyle ||\r\n      topBorderColor ||\r\n      topBorderStyle ||\r\n      bottomBorderColor ||\r\n      bottomBorderStyle\r\n    ) {\r\n      borderId = bordersIndex[borderKey]\r\n      if (borderId === undefined) {\r\n        borderId = bordersIndex[borderKey] = String(borders.length)\r\n        borders.push({\r\n          left: {\r\n            style: leftBorderStyle || borderStyle,\r\n            color: leftBorderColor || borderColor\r\n          },\r\n          right: {\r\n            style: rightBorderStyle || borderStyle,\r\n            color: rightBorderColor || borderColor\r\n          },\r\n          top: {\r\n            style: topBorderStyle || borderStyle,\r\n            color: topBorderColor || borderColor\r\n          },\r\n          bottom: {\r\n            style: bottomBorderStyle || borderStyle,\r\n            color: bottomBorderColor || borderColor\r\n          }\r\n        })\r\n      }\r\n    }\r\n    // Add a style.\r\n    styles.push({\r\n      fontId,\r\n      fillId,\r\n      borderId,\r\n      align,\r\n      alignVertical,\r\n      textRotation,\r\n      indent,\r\n      wrap,\r\n      formatId\r\n    })\r\n    return stylesIndex[key] = String(styles.length - 1)\r\n  }\r\n\r\n  // Add the default style.\r\n  getStyle({}, {})\r\n\r\n  return {\r\n    getStyles() {\r\n      return { formats, styles, fonts, fills, borders }\r\n    },\r\n    getStyle\r\n  }\r\n}"],"mappings":";;;;;;;AAAA,IAAAA,uBAAA,GAAAC,sBAAA,CAAAC,OAAA;AAAoD,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,gBAAAA,CAAA;AAEpD;AACA;AACO,IAAME,qBAAqB,GAAAC,OAAA,CAAAD,qBAAA,GAAG,GAAG;AAEzB,SAASE,UAAUA,CAAAC,IAAA,EAG/B;EAAA,IAFWC,iBAAiB,GAAAD,IAAA,CAA7BE,UAAU;IACAC,eAAe,GAAAH,IAAA,CAAzBI,QAAQ;EAER,IAAMC,UAAU,GAAGC,OAAO,CAACL,iBAAiB,IAAIE,eAAe,CAAC;EAEhE,IAAIF,iBAAiB,KAAKM,SAAS,EAAE;IACnCN,iBAAiB,GAAG,SAAS;EAC/B;EAEA,IAAIE,eAAe,KAAKI,SAAS,EAAE;IACjCJ,eAAe,GAAG,EAAE;EACtB;EAEA,IAAMK,OAAO,GAAG,EAAE;EAClB,IAAMC,YAAY,GAAG,CAAC,CAAC;EAEvB,IAAMC,MAAM,GAAG,EAAE;EACjB,IAAMC,WAAW,GAAG,CAAC,CAAC;EAEtB,IAAMC,KAAK,GAAG,EAAE;EAChB,IAAMC,UAAU,GAAG,CAAC,CAAC;EAErB,IAAMC,KAAK,GAAG,EAAE;EAChB,IAAMC,UAAU,GAAG,CAAC,CAAC;EAErB,IAAMC,OAAO,GAAG,EAAE;EAClB,IAAMC,YAAY,GAAG,CAAC,CAAC;;EAEvB;EACAL,KAAK,CAACM,IAAI,CAAC;IACTC,IAAI,EAAEhB,eAAe;IACrBiB,MAAM,EAAEnB,iBAAiB;IACzBoB,MAAM,EAAEhB;EACV,CAAC,CAAC;EACFQ,UAAU,CAAC,KAAK,CAAC,GAAG,CAAC;;EAErB;EACAC,KAAK,CAACI,IAAI,CAAC,CAAC,CAAC,CAAC;EACdH,UAAU,CAAC,GAAG,CAAC,GAAG,CAAC;;EAEnB;EACAC,OAAO,CAACE,IAAI,CAAC;IACXI,IAAI,EAAE,CAAC,CAAC;IACRC,KAAK,EAAE,CAAC,CAAC;IACTC,GAAG,EAAE,CAAC,CAAC;IACPC,MAAM,EAAE,CAAC;EACX,CAAC,CAAC;EACFR,YAAY,CAAC,iBAAiB,CAAC,GAAG,CAAC;;EAEnC;EACA;EACA;EACAH,KAAK,CAACI,IAAI,CAAC;IACTQ,OAAO,EAAE;EACX,CAAC,CAAC;EAEF,SAASC,QAAQA,CAAAC,KAAA,EAAAC,KAAA,EAwBd;IAAA,IAvBDC,KAAK,GAAAF,KAAA,CAALE,KAAK;MACLC,aAAa,GAAAH,KAAA,CAAbG,aAAa;MACbC,YAAY,GAAAJ,KAAA,CAAZI,YAAY;MACZC,MAAM,GAAAL,KAAA,CAANK,MAAM;MACNC,IAAI,GAAAN,KAAA,CAAJM,IAAI;MACJhC,UAAU,GAAA0B,KAAA,CAAV1B,UAAU;MACVE,QAAQ,GAAAwB,KAAA,CAARxB,QAAQ;MACR+B,UAAU,GAAAP,KAAA,CAAVO,UAAU;MACVC,SAAS,GAAAR,KAAA,CAATQ,SAAS;MACTC,KAAK,GAAAT,KAAA,CAALS,KAAK;MACLC,eAAe,GAAAV,KAAA,CAAfU,eAAe;MACfC,WAAW,GAAAX,KAAA,CAAXW,WAAW;MACXC,WAAW,GAAAZ,KAAA,CAAXY,WAAW;MACXC,eAAe,GAAAb,KAAA,CAAfa,eAAe;MACfC,eAAe,GAAAd,KAAA,CAAfc,eAAe;MACfC,gBAAgB,GAAAf,KAAA,CAAhBe,gBAAgB;MAChBC,gBAAgB,GAAAhB,KAAA,CAAhBgB,gBAAgB;MAChBC,cAAc,GAAAjB,KAAA,CAAdiB,cAAc;MACdC,cAAc,GAAAlB,KAAA,CAAdkB,cAAc;MACdC,iBAAiB,GAAAnB,KAAA,CAAjBmB,iBAAiB;MACjBC,iBAAiB,GAAApB,KAAA,CAAjBoB,iBAAiB;IAAA,IAEjBC,MAAM,GAAApB,KAAA,CAANoB,MAAM;IAEN;IACA,IAAMC,MAAM,GAAG3C,SAAS;IACxB;IACA,IAAM4C,OAAO,MAAAC,MAAA,CAAMlD,UAAU,IAAI,GAAG,OAAAkD,MAAA,CAAIhD,QAAQ,IAAI,GAAG,OAAAgD,MAAA,CAAIjB,UAAU,IAAI,GAAG,OAAAiB,MAAA,CAAIhB,SAAS,IAAI,GAAG,OAAAgB,MAAA,CAAIf,KAAK,IAAI,GAAG,CAAE;IAClH,IAAMgB,OAAO,GAAGf,eAAe,IAAI,GAAG;IACtC,IAAMgB,SAAS,GACb,GAAAF,MAAA,CAAIP,cAAc,IAAIN,WAAW,IAAK,GAAG,OAAAa,MAAA,CAAKN,cAAc,IAAIN,WAAW,IAAK,GAAG,IACnF,GAAG,MAAAY,MAAA,CACCT,gBAAgB,IAAIJ,WAAW,IAAK,GAAG,OAAAa,MAAA,CAAKR,gBAAgB,IAAIJ,WAAW,IAAK,GAAG,CAAE,GACzF,GAAG,MAAAY,MAAA,CACCL,iBAAiB,IAAIR,WAAW,IAAK,GAAG,OAAAa,MAAA,CAAKJ,iBAAiB,IAAIR,WAAW,IAAK,GAAG,CAAE,GAC3F,GAAG,MAAAY,MAAA,CACCX,eAAe,IAAIF,WAAW,IAAK,GAAG,OAAAa,MAAA,CAAKV,eAAe,IAAIF,WAAW,IAAK,GAAG,CAAE;IACzF,IAAMe,GAAG,MAAAH,MAAA,CAAMtB,KAAK,IAAI,GAAG,OAAAsB,MAAA,CAAIrB,aAAa,IAAI,GAAG,OAAAqB,MAAA,CAAIpB,YAAY,IAAI,GAAG,OAAAoB,MAAA,CAAInB,MAAM,IAAI,GAAG,OAAAmB,MAAA,CAAIlB,IAAI,IAAI,GAAG,OAAAkB,MAAA,CAAIH,MAAM,IAAI,GAAG,OAAAG,MAAA,CAAID,OAAO,OAAAC,MAAA,CAAIC,OAAO,OAAAD,MAAA,CAAIE,SAAS,CAAE;IAChK,IAAME,OAAO,GAAG7C,WAAW,CAAC4C,GAAG,CAAC;IAChC,IAAIC,OAAO,KAAKjD,SAAS,EAAE;MACzB,OAAOiD,OAAO;IAChB;IACA;IACA;IACA,IAAIC,QAAQ;IACZ,IAAIR,MAAM,EAAE;MACVQ,QAAQ,GAAGhD,YAAY,CAACwC,MAAM,CAAC;MAC/B,IAAIQ,QAAQ,KAAKlD,SAAS,EAAE;QAC1BkD,QAAQ,GAAGhD,YAAY,CAACwC,MAAM,CAAC,GAAGS,MAAM,CAAC7D,qBAAqB,GAAGW,OAAO,CAACmD,MAAM,CAAC;QAChFnD,OAAO,CAACU,IAAI,CAAC+B,MAAM,CAAC;MACtB;IACF;IACA;IACA,IAAIW,MAAM,GAAGvD,UAAU,GAAG,CAAC,GAAGE,SAAS;IACvC,IAAIL,UAAU,IAAIE,QAAQ,IAAI+B,UAAU,IAAIC,SAAS,IAAIC,KAAK,EAAE;MAC9DuB,MAAM,GAAG/C,UAAU,CAACsC,OAAO,CAAC;MAC5B,IAAIS,MAAM,KAAKrD,SAAS,EAAE;QACxBqD,MAAM,GAAG/C,UAAU,CAACsC,OAAO,CAAC,GAAGO,MAAM,CAAC9C,KAAK,CAAC+C,MAAM,CAAC;QACnD/C,KAAK,CAACM,IAAI,CAAC;UACTG,MAAM,EAAE,IAAI;UACZF,IAAI,EAAEf,QAAQ,IAAID,eAAe;UACjCiB,MAAM,EAAElB,UAAU,IAAID,iBAAiB;UACvC4D,MAAM,EAAE1B,UAAU;UAClB2B,KAAK,EAAE1B,SAAS;UAChBC,KAAK,EAALA;QACF,CAAC,CAAC;MACJ;IACF;IACA;IACA,IAAI0B,MAAM;IACV,IAAIzB,eAAe,EAAE;MACnByB,MAAM,GAAGhD,UAAU,CAACsC,OAAO,CAAC;MAC5B,IAAIU,MAAM,KAAKxD,SAAS,EAAE;QACxBwD,MAAM,GAAGhD,UAAU,CAACsC,OAAO,CAAC,GAAGK,MAAM,CAAC5C,KAAK,CAAC6C,MAAM,CAAC;QACnD7C,KAAK,CAACI,IAAI,CAAC;UACTmB,KAAK,EAAEC;QACT,CAAC,CAAC;MACJ;IACF;IACA;IACA,IAAI0B,QAAQ;IACZ,IACEzB,WAAW,IACXC,WAAW,IACXC,eAAe,IACfC,eAAe,IACfC,gBAAgB,IAChBC,gBAAgB,IAChBC,cAAc,IACdC,cAAc,IACdC,iBAAiB,IACjBC,iBAAiB,EACjB;MACAgB,QAAQ,GAAG/C,YAAY,CAACqC,SAAS,CAAC;MAClC,IAAIU,QAAQ,KAAKzD,SAAS,EAAE;QAC1ByD,QAAQ,GAAG/C,YAAY,CAACqC,SAAS,CAAC,GAAGI,MAAM,CAAC1C,OAAO,CAAC2C,MAAM,CAAC;QAC3D3C,OAAO,CAACE,IAAI,CAAC;UACXI,IAAI,EAAE;YACJwC,KAAK,EAAEpB,eAAe,IAAIF,WAAW;YACrCH,KAAK,EAAEI,eAAe,IAAIF;UAC5B,CAAC;UACDhB,KAAK,EAAE;YACLuC,KAAK,EAAElB,gBAAgB,IAAIJ,WAAW;YACtCH,KAAK,EAAEM,gBAAgB,IAAIJ;UAC7B,CAAC;UACDf,GAAG,EAAE;YACHsC,KAAK,EAAEhB,cAAc,IAAIN,WAAW;YACpCH,KAAK,EAAEQ,cAAc,IAAIN;UAC3B,CAAC;UACDd,MAAM,EAAE;YACNqC,KAAK,EAAEd,iBAAiB,IAAIR,WAAW;YACvCH,KAAK,EAAEU,iBAAiB,IAAIR;UAC9B;QACF,CAAC,CAAC;MACJ;IACF;IACA;IACA7B,MAAM,CAACQ,IAAI,CAAC;MACV0C,MAAM,EAANA,MAAM;MACNG,MAAM,EAANA,MAAM;MACNC,QAAQ,EAARA,QAAQ;MACRlC,KAAK,EAALA,KAAK;MACLC,aAAa,EAAbA,aAAa;MACbC,YAAY,EAAZA,YAAY;MACZC,MAAM,EAANA,MAAM;MACNC,IAAI,EAAJA,IAAI;MACJuB,QAAQ,EAARA;IACF,CAAC,CAAC;IACF,OAAO9C,WAAW,CAAC4C,GAAG,CAAC,GAAGG,MAAM,CAAChD,MAAM,CAACiD,MAAM,GAAG,CAAC,CAAC;EACrD;;EAEA;EACAhC,QAAQ,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;EAEhB,OAAO;IACLsC,SAAS,WAATA,SAASA,CAAA,EAAG;MACV,OAAO;QAAEzD,OAAO,EAAPA,OAAO;QAAEE,MAAM,EAANA,MAAM;QAAEE,KAAK,EAALA,KAAK;QAAEE,KAAK,EAALA,KAAK;QAAEE,OAAO,EAAPA;MAAQ,CAAC;IACnD,CAAC;IACDW,QAAQ,EAARA;EACF,CAAC;AACH","ignoreList":[]}