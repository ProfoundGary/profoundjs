{"version":3,"file":"row.js","names":["_cell","_interopRequireDefault","require","_getCellStyleProperties","_getAttributesString","e","__esModule","_typeof","o","Symbol","iterator","constructor","prototype","generateRow","row","rowIndex","_ref","getStyle","getSharedString","customFont","dateFormat","usesSchema","rowNumber","rowHeight","rowCells","map","cell","columnIndex","undefined","height","cellStyleProperties","getCellStyleProperties","type","value","format","isEmpty","detectValueType","String","Date","Number","Error","cellStyleId","generateCell","join","rowAttributes","r","ht","customHeight","concat","getAttributesString","Boolean"],"sources":["../../../../source/write/files/sheet.xml/row.js"],"sourcesContent":["// Copy-pasted from:\r\n// https://github.com/davidramos-om/zipcelx-on-steroids/blob/master/src/formatters/rows/formatRow.js\r\n\r\nimport generateCell from './cell.js'\r\nimport getCellStyleProperties from './helpers/getCellStyleProperties.js'\r\nimport getAttributesString from '../../../xml/getAttributesString.js'\r\n\r\n// import Integer from '../types/Integer.js'\r\n\r\nexport default function generateRow(row, rowIndex, {\r\n\tgetStyle,\r\n\tgetSharedString,\r\n\tcustomFont,\r\n\tdateFormat,\r\n\tusesSchema\r\n}) {\r\n\t// To ensure the row number starts as in Excel.\r\n\tconst rowNumber = rowIndex + 1\r\n\tlet rowHeight\r\n\tconst rowCells = row\r\n\t\t.map((cell, columnIndex) => {\r\n\t\t\tif (cell === undefined || cell === null) {\r\n\t\t\t\treturn ''\r\n\t\t\t}\r\n\r\n\t\t\tconst {\r\n\t\t\t\theight\r\n\t\t\t} = cell\r\n\r\n\t\t\tconst cellStyleProperties = getCellStyleProperties(cell)\r\n\r\n\t\t\tlet {\r\n\t\t\t\ttype,\r\n\t\t\t\tvalue,\r\n\t\t\t\tformat\r\n\t\t\t} = cell\r\n\r\n\t\t\tif (isEmpty(value)) {\r\n\t\t\t\tvalue = null\r\n\t\t\t} else {\r\n\t\t\t\t// Get cell value type.\r\n\t\t\t\tif (type === undefined) {\r\n\t\t\t\t\tif (!usesSchema) {\r\n\t\t\t\t\t\ttype = detectValueType(value)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (type === undefined) {\r\n\t\t\t\t\t\t// The default cell value type is `String`.\r\n\t\t\t\t\t\ttype = String\r\n\t\t\t\t\t\tvalue = String(value)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Validate `format` property.\r\n\t\t\tif (format) {\r\n\t\t\t\tif (type !== Date && type !== Number && type !== String && type !== 'Formula') { // && type !== Integer) {\r\n\t\t\t\t\tthrow new Error('`format` can only be used on `Date`, `Number`, `String` or `\"Formula\"` cells') // or `Integer` cells')\r\n\t\t\t\t}\r\n\t\t\t\tif (type === String && format !== '@') {\r\n\t\t\t\t\tthrow new Error('`String` cells only support \"@\" `format`')\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (type === Date) {\r\n\t\t\t\t\tformat = dateFormat\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tlet cellStyleId\r\n\t\t\tif (\r\n\t\t\t\tformat ||\r\n\t\t\t\tcustomFont ||\r\n\t\t\t\tcellStyleProperties\r\n\t\t\t) {\r\n\t\t\t\tcellStyleId = getStyle(cellStyleProperties || {}, { format })\r\n\t\t\t}\r\n\r\n\t\t\tif (height) {\r\n\t\t\t\tif (rowHeight === undefined || rowHeight < height) {\r\n\t\t\t\t\trowHeight = height\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn generateCell(\r\n\t\t\t\trowNumber,\r\n\t\t\t\tcolumnIndex,\r\n\t\t\t\tvalue,\r\n\t\t\t\ttype,\r\n\t\t\t\tcellStyleId,\r\n\t\t\t\tgetSharedString\r\n\t\t\t)\r\n\t\t})\r\n\t\t.join('')\r\n\r\n\tconst rowAttributes = {\r\n\t\tr: rowNumber\r\n\t}\r\n\r\n\tif (rowHeight) {\r\n\t\trowAttributes.ht = rowHeight\r\n\t\trowAttributes.customHeight = 1\r\n\t}\r\n\r\n\treturn `<row${getAttributesString(rowAttributes)}>` +\r\n\t\trowCells +\r\n\t\t'</row>'\r\n}\r\n\r\nfunction isEmpty(value) {\r\n  return value === undefined || value === null || value === ''\r\n}\r\n\r\nfunction detectValueType(value) {\r\n  switch (typeof value) {\r\n    case 'string':\r\n      return String\r\n    case 'number':\r\n      return Number\r\n    case 'boolean':\r\n      return Boolean\r\n    default:\r\n      if (value instanceof Date) {\r\n        return Date\r\n      }\r\n  }\r\n}"],"mappings":"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","ignoreList":[]}