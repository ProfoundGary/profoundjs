{"version":3,"file":"sheet.xml.js","names":["_rows","_interopRequireDefault","require","_columns","_processMergedCells2","_mergedCellsDescription","_layout","_views","_drawing","e","__esModule","SHEET_XML_TEMPLATE","generateSheetXml","data_","_ref","schema","columns","images","getHeaderStyle","getStyle","getSharedString","customFont","dateFormat","orientation","stickyRowsCount","stickyColumnsCount","showGridLines","rightToLeft","sheetId","validateData","_processMergedCells","processMergedCells","data","mergedCells","replace","generateRows","generateViews","generateColumnsDescription","generateMergedCellsDescription","generateLayout","generateDrawing","_ref2","Array","isArray","TypeError","length"],"sources":["../../../../source/write/files/sheet.xml/sheet.xml.js"],"sourcesContent":["// Copy-pasted from:\r\n// https://github.com/davidramos-om/zipcelx-on-steroids/blob/master/src/zipcelx.js\r\n// https://github.com/davidramos-om/zipcelx-on-steroids/blob/master/src/templates/worksheet.xml.js\r\n\r\nimport generateRows from './rows.js'\r\nimport generateColumnsDescription from './columns.js'\r\nimport processMergedCells from './processMergedCells.js'\r\nimport generateMergedCellsDescription from './mergedCellsDescription.js'\r\nimport generateLayout from './layout.js'\r\nimport generateViews from './views.js'\r\nimport generateDrawing from './drawing.js'\r\n\r\nconst SHEET_XML_TEMPLATE = `<?xml version=\"1.0\" ?>\r\n<worksheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" xmlns:mv=\"urn:schemas-microsoft-com:mac:vml\" xmlns:mx=\"http://schemas.microsoft.com/office/mac/excel/2008/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:x14=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\" xmlns:xm=\"http://schemas.microsoft.com/office/excel/2006/main\">{views}{columnsDescription}<sheetData>{data}</sheetData>{mergedCellsDescription}{layout}{drawing}</worksheet>`;\r\n\r\nexport default function generateSheetXml(data_, {\r\n\tschema,\r\n\tcolumns,\r\n\timages,\r\n\tgetHeaderStyle,\r\n\tgetStyle,\r\n\tgetSharedString,\r\n\tcustomFont,\r\n\tdateFormat,\r\n\torientation,\r\n\tstickyRowsCount,\r\n\tstickyColumnsCount,\r\n\tshowGridLines,\r\n\trightToLeft,\r\n\tsheetId\r\n}) {\r\n\tvalidateData(data_, { schema })\r\n\r\n\tconst { data, mergedCells } = processMergedCells(data_, { schema })\r\n\r\n  return SHEET_XML_TEMPLATE\r\n  \t.replace('{data}', generateRows(data, {\r\n  \t\tschema,\r\n  \t\tgetHeaderStyle,\r\n  \t\tgetStyle,\r\n  \t\tgetSharedString,\r\n  \t\tcustomFont,\r\n  \t\tdateFormat\r\n  \t}))\r\n  \t.replace('{views}', generateViews({ stickyRowsCount, stickyColumnsCount, showGridLines, rightToLeft }))\r\n  \t.replace('{columnsDescription}', generateColumnsDescription({ schema, columns }))\r\n  \t.replace('{mergedCellsDescription}', generateMergedCellsDescription(mergedCells))\r\n  \t.replace('{layout}', generateLayout({ sheetId, orientation }))\r\n  \t.replace('{drawing}', generateDrawing({ images }))\r\n}\r\n\r\nfunction validateData(data, { schema }) {\r\n\tif (schema) {\r\n\t\tif (!Array.isArray(data)) {\r\n\t\t\tthrow new TypeError('Expected an array of objects')\r\n\t\t}\r\n\t} else {\r\n\t\tif (!Array.isArray(data)) {\r\n\t\t\tthrow new TypeError('Expected an array of arrays')\r\n\t\t}\r\n\t\tif (data.length > 0) {\r\n\t\t\tif (!Array.isArray(data[0])) {\r\n\t\t\t\tthrow new TypeError('Expected an array of arrays')\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}"],"mappings":"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","ignoreList":[]}