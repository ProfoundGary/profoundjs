{"version":3,"file":"styles.xml.js","names":["_sanitizeAttributeValue","_interopRequireDefault","require","_styles","e","__esModule","_createForOfIteratorHelperLoose","r","t","Symbol","iterator","call","next","bind","Array","isArray","_unsupportedIterableToArray","length","o","done","value","TypeError","a","_arrayLikeToArray","toString","slice","constructor","name","from","test","n","generateStylesXml","_ref","formats","styles","fonts","fills","borders","xml","concat","i","FORMAT_ID_STARTS_FROM","$attr","_iterator","_step","font","size","family","color","weight","style","custom","getColor","_iterator2","_step2","fill","gray125","_iterator3","_step3","border","left","right","top","bottom","getBorderXml","direction","_ref2","hasChildren","_iterator4","_step4","cellStyle","fontId","fillId","borderId","align","alignVertical","textRotation","indent","wrap","formatId","undefined","filter","_","join","getTextRotation","validateTextRotation","String","Error","toUpperCase"],"sources":["../../../source/write/files/styles.xml.js"],"sourcesContent":["import $attr from '../../xml/sanitizeAttributeValue.js'\r\nimport { FORMAT_ID_STARTS_FROM } from '../styles.js'\r\n\r\nexport default function generateStylesXml({ formats, styles, fonts, fills, borders }) {\r\n  let xml = '<?xml version=\"1.0\" ?>'\r\n  xml += '<styleSheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\">'\r\n\r\n  // Turns out, as weird as it sounds, the order of XML elements matters to MS Office Excel.\r\n  // https://social.msdn.microsoft.com/Forums/office/en-US/cc47ab65-dab7-4e32-b676-b641aa1e1411/how-to-validate-the-xlsx-that-i-generate?forum=oxmlsdk\r\n  // For example, previously this library was inserting `<cellXfs/>` before `<fonts/>`\r\n  // and that caused MS Office 2007 Excel to throw an error about the file being corrupt:\r\n  // \"Excel found unreadable content in '*.xlsx'. Do you want to recover the contents of this workbook?\"\r\n  // \"Excel was able to open the file by repairing or removing the unreadable content.\"\r\n  // \"Removed Part: /xl/styles.xml part with XML error.  (Styles) Load error. Line 1, column ...\"\r\n  // \"Repaired Records: Cell information from /xl/worksheets/sheet1.xml part\"\r\n\r\n  if (formats.length > 0) {\r\n    xml += `<numFmts count=\"${formats.length}\">`\r\n    for (let i = 0; i < formats.length; i++) {\r\n      xml += `<numFmt numFmtId=\"${FORMAT_ID_STARTS_FROM + i}\" formatCode=\"${$attr(formats[i])}\"/>`\r\n    }\r\n    xml += `</numFmts>`\r\n  }\r\n\r\n  xml += `<fonts count=\"${fonts.length}\">`\r\n  for (const font of fonts) {\r\n    const {\r\n      size,\r\n      family,\r\n      color,\r\n      weight,\r\n      style,\r\n      custom\r\n    } = font\r\n    xml += '<font>'\r\n    xml += `<sz val=\"${size}\"/>`\r\n    xml += `<color ${color ? 'rgb=\"' + $attr(getColor(color)) + '\"' : 'theme=\"1\"'}/>`\r\n    xml += `<name val=\"${$attr(family)}\"/>`\r\n    // It's not clear what the `<family/>` tag means or does.\r\n    // It seems to always be `<family val=\"2\"/>` even for different\r\n    // font families (Calibri, Arial, etc).\r\n    xml += '<family val=\"2\"/>'\r\n    //\r\n    // It's not clear what the `<scheme/>` tag means or does.\r\n    // Seems like it's only preset for the default \"Calibri\" font.\r\n    // Adding it to any other font resets the font family in Microsoft Excel 2007.\r\n    //\r\n    // \"Defines the font scheme, if any, to which this font belongs.\r\n    //  When a font definition is part of a theme definition, then the font\r\n    //  is categorized as either a \"major\" or \"minor\" font scheme component.\r\n    //  When a new theme is chosen, every font that is part of a theme definition\r\n    //  is updated to use the new \"major\" or \"minor\" font definition for that theme.\r\n    //  Usually \"major\" fonts are used for styles like headings,\r\n    //  and \"minor\" fonts are used for body and paragraph text.\"\r\n    //\r\n    // https://hackage.haskell.org/package/xlsx-0.8.4/docs/Codec-Xlsx-Types-StyleSheet.html\r\n    //\r\n    if (!custom) {\r\n      xml += '<scheme val=\"minor\"/>'\r\n    }\r\n    if (weight === 'bold') {\r\n      xml += '<b/>'\r\n    }\r\n    if (style === 'italic') {\r\n      xml += '<i/>'\r\n    }\r\n    xml += '</font>'\r\n  }\r\n  xml += '</fonts>'\r\n\r\n  // MS Office 2007 Excel seems to require a `<fills/>` element to exist.\r\n  // without it, MS Office 2007 Excel thinks that the file is broken.\r\n  xml += `<fills count=\"${fills.length}\">`\r\n  for (const fill of fills) {\r\n    const { color, gray125 } = fill\r\n    xml += '<fill>'\r\n    if (color) {\r\n      xml += '<patternFill patternType=\"solid\">'\r\n      xml += `<fgColor rgb=\"${$attr(getColor(color))}\"/>`\r\n      // Whatever that could mean.\r\n      xml += '<bgColor indexed=\"64\"/>'\r\n      xml += '</patternFill>'\r\n    } else if (gray125) {\r\n      // \"gray125\" fill.\r\n      // For some weird reason, MS Office 2007 Excel seems to require that to be present.\r\n      // Otherwise, if absent, it would replace the first `backgroundColor`.\r\n      xml += '<patternFill patternType=\"gray125\"/>'\r\n    } else {\r\n      xml += '<patternFill patternType=\"none\"/>'\r\n    }\r\n    xml += '</fill>'\r\n  }\r\n  xml += '</fills>'\r\n\r\n  // MS Office 2007 Excel seems to require a `<borders/>` element to exist:\r\n  // without it, MS Office 2007 Excel thinks that the file is broken.\r\n  xml += `<borders count=\"${borders.length}\">`\r\n  for (const border of borders) {\r\n    const {\r\n      left,\r\n      right,\r\n      top,\r\n      bottom\r\n    } = border\r\n    const getBorderXml = (direction, { style, color }) => {\r\n      if (color && !style) {\r\n        style = 'thin'\r\n      }\r\n      const hasChildren = color ? true : false\r\n      return `<${direction}` +\r\n        (style ? ` style=\"${$attr(style)}\"` : '') +\r\n        (hasChildren ? '>' : '/>') +\r\n        (color ? `<color rgb=\"${$attr(getColor(color))}\"/>` : '') +\r\n        (hasChildren ? `</${direction}>` : '')\r\n    }\r\n    xml += '<border>'\r\n    xml += getBorderXml('left', left)\r\n    xml += getBorderXml('right', right)\r\n    xml += getBorderXml('top', top)\r\n    xml += getBorderXml('bottom', bottom)\r\n    xml += '<diagonal/>'\r\n    xml += '</border>'\r\n  }\r\n  xml += '</borders>'\r\n\r\n  // What are `<cellXfs/>` and `<cellStyleXfs/>`:\r\n  // http://officeopenxml.com/SSstyles.php\r\n  //\r\n  // `<cellStyleXfs/>` are referenced from `<cellXfs/>` as `<xf xfId=\"...\"/>`.\r\n  // `<cellStyleXfs/>` defines abstract \"cell styles\" that can be \"extended\"\r\n  // by \"cell styles\" defined by `<cellXfs/>` that can be applied to individual cells:\r\n  // 1. `<cellStyleXfs><xf .../></cellStyleXfs>`\r\n  // 2. `<cellXfs><xf xfId={cellStyleXfs.xf.index}/></cellXfs>`\r\n  // 3. `<c s={cellXfs.xf.index}/>`\r\n  // Seems like \"cell styles\" defined by `<cellXfs/>` have to reference\r\n  // some abstract \"cell styles\" defined by `<cellStyleXfs/>` by the spec.\r\n  // Otherwise, there would be no need to use `<cellStyleXfs/>` at all.\r\n  // The naming is ambiguous and weird. The whole scheme is needlessly redundant.\r\n\r\n  // xml += '<cellStyleXfs count=\"2\">'\r\n  // xml += '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\"/>'\r\n  // // `applyFont=\"1\"` means apply a custom font in this \"abstract\" \"cell style\"\r\n  // // rather than using a default font.\r\n  // // Seems like by default `applyFont` is `\"0\"` meaning that,\r\n  // // unless `\"1\"` is specified, it would ignore the `fontId` attribute.\r\n  // xml += '<xf numFmtId=\"0\" fontId=\"1\" applyFont=\"1\" fillId=\"0\" borderId=\"0\"/>'\r\n  // xml += '</cellStyleXfs>'\r\n\r\n  xml += `<cellXfs count=\"${styles.length}\">`\r\n  for (const cellStyle of styles) {\r\n    const {\r\n      fontId,\r\n      fillId,\r\n      borderId,\r\n      align,\r\n      alignVertical,\r\n      textRotation,\r\n      indent,\r\n      wrap,\r\n      formatId\r\n    } = cellStyle\r\n    // `applyNumberFormat=\"1\"` means \"apply the `numFmtId` attribute\".\r\n    // Seems like by default `applyNumberFormat` is `\"0\"` meaning that,\r\n    // unless `\"1\"` is specified, it would ignore the `numFmtId` attribute.\r\n    xml += '<xf ' +\r\n      [\r\n        formatId !== undefined ? `numFmtId=\"${formatId}\"` : undefined,\r\n        formatId !== undefined ? 'applyNumberFormat=\"1\"' : undefined,\r\n        fontId !== undefined ? `fontId=\"${fontId}\"` : undefined,\r\n        fontId !== undefined ? 'applyFont=\"1\"' : undefined,\r\n        fillId !== undefined ? `fillId=\"${fillId}\"` : undefined,\r\n        fillId !== undefined ? 'applyFill=\"1\"' : undefined,\r\n        borderId !== undefined ? `borderId=\"${borderId}\"` : undefined,\r\n        borderId !== undefined ? 'applyBorder=\"1\"' : undefined,\r\n        align || alignVertical || textRotation || indent || wrap ? 'applyAlignment=\"1\"' : undefined,\r\n        // 'xfId=\"0\"'\r\n      ].filter(_ => _).join(' ') +\r\n    '>' +\r\n      // Possible horizontal alignment values:\r\n      //  left, center, right, fill, justify, center_across, distributed.\r\n      // Possible vertical alignment values:\r\n      //  top, vcenter, bottom, vjustify, vdistributed.\r\n      // https://xlsxwriter.readthedocs.io/format.html#set_align\r\n      (align || alignVertical || textRotation || indent || wrap\r\n        ? '<alignment' +\r\n          (align ? ` horizontal=\"${$attr(align)}\"` : '') +\r\n          (alignVertical ? ` vertical=\"${$attr(alignVertical)}\"` : '') +\r\n          (textRotation ? ` textRotation=\"${getTextRotation(validateTextRotation(textRotation))}\"` : '') +\r\n          (indent ? ` indent=\"${$attr(String(indent))}\"` : '') +\r\n          (wrap ? ` wrapText=\"1\"` : '') +\r\n          '/>'\r\n        : ''\r\n      ) +\r\n    '</xf>'\r\n  }\r\n  xml += `</cellXfs>`\r\n\r\n  xml += '</styleSheet>'\r\n\r\n  return xml\r\n}\r\n\r\nfunction getColor(color) {\r\n  if (color[0] !== '#') {\r\n    throw new Error(`Color \"${color}\" must start with a \"#\"`)\r\n  }\r\n  return `FF${color.slice('#'.length).toUpperCase()}`\r\n}\r\n\r\n// Validates text rotation parameter value.\r\n// Text rotation parameter value could be from -90 to 90.\r\n// Positive values rotate the text counterclockwise, and negative values rotate the text clockwise.\r\n//\r\n// The spec-compliant `textRotation` parameter value is weird.\r\n// See `getTextRotation()` function comments.\r\n//\r\n// I've searched the internet on how other libraries expect text rotation parameter to look like.\r\n// The consensus seems to be \"-90...90\" so that it's not as weird as the official spec defines it.\r\n//\r\n// In ClosedXML .NET library, it allows the values from -90 to 90:\r\n// https://docs.closedxml.io/en/latest/features/cell-format.html#orientation\r\n//\r\n// In XlsxWriter Python library, it's -90 to 90 with 270 as a special magic value:\r\n// https://xlsxwriter.readthedocs.io/format.html#format-set-rotation\r\n//\r\n// In Apache POI, it's also -90 to 90 and 255 as a special magic value:\r\n// https://copyprogramming.com/howto/how-to-rotate-text-in-a-spreadsheet-cell-using-apache-poi\r\n//\r\n// \"Specify the angle of rotation for the text within the cell.\r\n//  The degree of rotation can range between -90 and 90 degrees, or it can be set to 0xff for vertical alignment.\"\r\n//\r\n// So -90 to 90 seems like a common-practice value range.\r\n//\r\nfunction validateTextRotation(textRotation) {\r\n  if (!(textRotation >= -90 && textRotation <= 90)) {\r\n    throw new Error(`Unsupported text rotation angle: ${textRotation}. Values from -90 to 90 are supported.`);\r\n  }\r\n  return textRotation\r\n}\r\n\r\n// Transforms `textRotation` parameter value to the spec-compliant form.\r\n//\r\n// The XLSX specification for the value of `textRotation` is weird:\r\n// https://learn.microsoft.com/en-us/dotnet/api/documentformat.openxml.spreadsheet.alignment?view=openxml-2.8.1\r\n//\r\n// \"Text rotation in cells. Expressed in degrees. Values range from 0 to 180.\r\n//  The first letter of the text is considered the center-point of the arc.\r\n//  For 0 - 90, the value represents degrees above horizon.\r\n//  For 91-180 the degrees below the horizon is calculated as:\r\n//  [degrees below horizon] = 90 - textRotation\"\r\n//\r\nfunction getTextRotation(textRotation) {\r\n  if (textRotation < 0) {\r\n    return 90 - textRotation\r\n  }\r\n  return textRotation\r\n}"],"mappings":"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","ignoreList":[]}