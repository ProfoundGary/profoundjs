{"version":3,"file":"[Content_Types].xml.js","names":["_getFileExtensionForContentType","_interopRequireDefault","require","e","__esModule","_createForOfIteratorHelperLoose","r","t","Symbol","iterator","call","next","bind","Array","isArray","_unsupportedIterableToArray","length","o","done","value","TypeError","a","_arrayLikeToArray","toString","slice","constructor","name","from","test","n","generateContentTypesXml","_ref","images","sheets","map","_ref2","id","concat","join","_ref3","getFileExtensionContentTypes","_ref4","fileExtension","contentType","fileExtensionContentTypes","addFileExtensionContentType","image","getFileExtensionForContentType","existingFileExtensionContentType","find","_","push","_iterator","_step","sheetImages","_iterator2","_step2","_iterator3","_step3"],"sources":["../../../source/write/files/[Content_Types].xml.js"],"sourcesContent":["import getFileExtensionForContentType from '../getFileExtensionForContentType.js'\r\n\r\n// Copy-pasted from:\r\n// https://github.com/davidramos-om/zipcelx-on-steroids/blob/master/src/statics/%5BContent_Types%5D.xml.js\r\n\r\nexport default function generateContentTypesXml({ images, sheets }) {\r\n\treturn '<?xml version=\"1.0\" ?>' +\r\n\t\t'<Types xmlns=\"http://schemas.openxmlformats.org/package/2006/content-types\">' +\r\n\t\t\t'<Default ContentType=\"application/xml\" Extension=\"xml\"/>' +\r\n\t\t\t'<Default ContentType=\"application/vnd.openxmlformats-package.relationships+xml\" Extension=\"rels\"/>' +\r\n\t\t\tsheets.map(({ id }) => `<Override ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\" PartName=\"/xl/worksheets/sheet${id}.xml\"/>`).join('') +\r\n\t\t\tsheets.map(({ id, images }) => images ? `<Override ContentType=\"application/vnd.openxmlformats-officedocument.drawing+xml\" PartName=\"/xl/drawings/drawing${id}.xml\"/>` : '').join('') +\r\n\t\t\t'<Override ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\" PartName=\"/xl/workbook.xml\"/>' +\r\n\t\t\t'<Override ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml\" PartName=\"/xl/sharedStrings.xml\"/>' +\r\n\t\t\t'<Override ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\" PartName=\"/xl/styles.xml\"/>' +\r\n\t\t\tgetFileExtensionContentTypes(images).map(({ fileExtension, contentType }) => `<Default Extension=\"${fileExtension}\" ContentType=\"${contentType}\"/>`).join('') +\r\n\t\t'</Types>'\r\n}\r\n\r\nfunction getFileExtensionContentTypes(images) {\r\n\tif (!images) {\r\n\t\treturn []\r\n\t}\r\n\r\n\tconst fileExtensionContentTypes = []\r\n\r\n\tconst addFileExtensionContentType = (image) => {\r\n\t\tconst fileExtension = getFileExtensionForContentType(image.contentType)\r\n\t\tconst existingFileExtensionContentType = fileExtensionContentTypes.find(_ => _.fileExtension === fileExtension)\r\n\t\tif (!existingFileExtensionContentType) {\r\n\t\t\tfileExtensionContentTypes.push({\r\n\t\t\t\tfileExtension,\r\n\t\t\t\tcontentType: image.contentType\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tif (Array.isArray(images[0])) {\r\n\t\tfor (const sheetImages of images) {\r\n\t\t\tfor (const image of sheetImages) {\r\n\t\t\t\taddFileExtensionContentType(image)\r\n\t\t\t}\r\n\t\t}\r\n\t} else {\r\n\t\tfor (const image of images) {\r\n\t\t\taddFileExtensionContentType(image)\r\n\t\t}\r\n\t}\r\n\r\n\treturn fileExtensionContentTypes\r\n}"],"mappings":"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","ignoreList":[]}